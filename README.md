# DatLibrarian

[![Stability](https://img.shields.io/badge/stability-stable-green.svg?style=flat-square)](https://nodejs.org/api/documentation.html#documentation_stability_index)
[![JS Standard Style](https://img.shields.io/badge/code%20style-standard-brightgreen.svg?style=flat-square)](https://github.com/feross/standard)

A dedicated [Dat](https://datproject.org/) peer.

## Install

Install DatLibrarian and its dependencies with [npm](<>):

```bash
npm i -S dat-librarian
```

Then you can use it in your project:

```javascript
const DatLibrarian = require('dat-librarian')
const librarian = new Datlibrarian({ dir: '.dats' })
```

## Usage

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [DatLibrarian](#datlibrarian)
    -   [load](#load)
    -   [get](#get)
    -   [add](#add)
    -   [remove](#remove)
    -   [list](#list)
    -   [keys](#keys)
    -   [close](#close)
    -   [resolve](#resolve)

DatLibrarian is a dedicated [Dat](http://datproject.org/) peer similar to
[hypercore-archiver](https://github.com/mafintosh/hypercore-archiver)
that persists archives to disk and seeds them to the network.

**Examples**

```javascript
const DatLibrarian = require('dat-librarian')
const librarian = new DatLibrarian({ dir: '.dats' })
librarian
  // load pre-existing archives
  .load()
  // promises!
  .then(() => {
    // use keys or links per dat-link-resolve
    return librarian.add('garbados.hashbase.io')
  })
```

### DatLibrarian

Instantiate a new DatLibriarian.

**Parameters**

-   `options` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Options object.
    -   `options.dir` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The librarian's working directory, where it will cache archives. Required.
    -   `options.dat` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Options object passed to Dat()
    -   `options.net` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Options object passed to dat.joinNetwork()

#### load

Load Dat archives into cache by checking the working
directory for existing archives.

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)>** A promise that resolves once any existing archives have been loaded into the cache.

#### get

Get an archive from the cache by link.

**Parameters**

-   `link` **([String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Buffer](https://nodejs.org/api/buffer.html))** Link to a Dat archive.

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;Dat>** Promise that resolves to a Dat archive.

#### add

Add an archive by link. Automatically joins the network
and begins downloading, but does not wait for the archive
to complete.

**Parameters**

-   `link` **([String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Buffer](https://nodejs.org/api/buffer.html))** Link to a Dat archive.

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that resolves once the archive has been added to the cache.

#### remove

Remove an archive from the cache and the working directory.

**Parameters**

-   `link` **([String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Buffer](https://nodejs.org/api/buffer.html))** Link to a Dat archive.

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** A promise that resolves once the archive has been removed.

#### list

Lists the keys in the cache.

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** An array of all the keys in the cache.

#### keys

Getter for the keys in the cache. Alias to #list()

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** An array of all the keys in the cache.

#### close

Close the librarian and any archives it is peering.

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** Promise that resolves once all archives have closed.

#### resolve

Promification of dat-link-resolve
for convenience's sake.

**Parameters**

-   `link` **([String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) \| [Buffer](https://nodejs.org/api/buffer.html))** Link to a Dat archive

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[Buffer](https://nodejs.org/api/buffer.html)>** Key of that Dat archive

## Development

Download the source and run the test suite:

    git clone garbados/dat-librarian
    cd dat-librarian
    npm install
    npm test

## Contributions

All contributions are welcome: bug reports, feature requests, "why doesn't this work" questions, patches for fixes and features, etc. For all of the above, [file an issue](https://github.com/garbados/dat-librarian/issues) or [submit a pull request](https://github.com/garbados/dat-librarian/pulls).

## License

[Apache-2.0](https://www.apache.org/licenses/LICENSE-2.0)
